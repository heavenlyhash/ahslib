<?xml version="1.0" encoding="UTF-8"?>
<project name="AHSlib" basedir="." default="dist">
	<description>
		The "And How Simple!" library provides open-source Java
		solutions for rapid development of applications utilizing
		networking, serialization/persistence, concurrency control, and
		thread scheduling. The primary goals of AHSlib are remove
		common drudgery from coding in java wherever possible, make
		writing multithreaded applications easier, and codify common
		design patterns so that good code becomes more self-documenting.
		
		AHSlib is tested for both stability and performance and comes
		complete with an abundance of abstract interfaces that made it
		sufficient to provide services to a diverse range of projects.
	</description>
	
	<echo>Ant version:       ${ant.version}</echo>
	<echo>Ant jvm version:   ${ant.java.version}</echo>
	<import file="build-common.xml"/> 
	
	
	<target name="init">
		<tstamp/>
		<mkdir dir="build"/>
		<mkdir dir="dist"/>
		<mkdir dir="dox/javadoc"/>
	</target>
	
	
	<target name="compile"
		depends="
			compile-core,
			compile-codec,
			compile-codec-json,
			compile-codec-ebon,
			compile-codec-pre,
			compile-log,
			compile-test,
			compile-test-junit,
			compile-thread,
			compile-io"
		description="compile the source">
	</target>
	<target name="dist"
		depends="
			dist-core,
			dist-codec,
			dist-codec-json,
			dist-codec-ebon,
			dist-codec-pre,
			dist-log,
			dist-test,
			dist-test-junit,
			dist-thread,
			dist-io,
			dist-complete"
		description="pack jars">
	</target>
	<target name="compile-core" depends="init">
		<ahsjavac
			module="core"
			classes="us/exultant/ahs/core/**, us/exultant/ahs/util/**"
			depends=""
		/>
	</target>
	<target name="dist-core" depends="compile-core">
		<jar jarfile="dist/ahslib-core.jar" basedir="build/core"/>
	</target>
	
	<target name="compile-codec" depends="compile-core">
		<ahsjavac
			module="codec"
			classes="us/exultant/ahs/codec/*, us/exultant/ahs/codec/eon/*"
			depends="build/core"
		/>
	</target>
	<target name="dist-codec" depends="compile-codec">
		<jar jarfile="dist/ahslib-codec.jar" basedir="build/codec"/>
	</target>
	
	<target name="compile-codec-json" depends="compile-codec">
		<ahsjavac
			module="codec-json"
			classes="us/exultant/ahs/codec/json/**"
			depends="build/codec : build/core"
		/>
	</target>
	<target name="dist-codec-json" depends="compile-codec-json">
		<jar jarfile="dist/ahslib-codec-json.jar" basedir="build/codec-json"/>
	</target>
	
	<target name="compile-codec-ebon" depends="compile-codec">
		<ahsjavac
			module="codec-ebon"
			classes="us/exultant/ahs/codec/ebon/**"
			depends="build/codec : build/core"
		/>
	</target>
	<target name="dist-codec-ebon" depends="compile-codec-ebon">
		<jar jarfile="dist/ahslib-codec-ebon.jar" basedir="build/codec-ebon"/>
	</target>
		
	<target name="compile-codec-pre" depends="compile-codec">
		<ahsjavac
			module="codec-pre"
			classes="us/exultant/ahs/codec/eon/pre/**"
			depends="build/codec : build/core"
		/>
	</target>
	<target name="dist-codec-pre" depends="compile-codec-pre">
		<jar jarfile="dist/ahslib-codec-pre.jar" basedir="build/codec-pre"/>
	</target>
	
	<target name="compile-log" depends="compile-core">
		<ahsjavac
			module="log"
			classes="us/exultant/ahs/log/**"
			depends="build/core"
		/>
	</target>
	<target name="dist-log" depends="compile-log">
		<jar jarfile="dist/ahslib-log.jar" basedir="build/log"/>
	</target>
	
	<target name="compile-test" depends="compile-log">
		<ahsjavac
			module="test"
			classes="us/exultant/ahs/test/*.java"
			depends="build/core : build/log"
		/>
	</target>
	<target name="dist-test" depends="compile-test">
		<jar jarfile="dist/ahslib-test.jar" basedir="build/test"/>
	</target>
	<target name="compile-test-junit" depends="compile-test">
		<ahsjavac
			module="test-junit"
			classes="us/exultant/ahs/test/junit/**"
			depends="build/core : build/log : lib/junit.jar"
		/>
	</target>
	<target name="dist-test-junit" depends="compile-test-junit">
		<jar jarfile="dist/ahslib-test-junit.jar" basedir="build/test-junit"/>
	</target>
	
	<target name="compile-thread" depends="compile-core">
		<ahsjavac
			module="thread"
			classes="us/exultant/ahs/thread/**"
			depends="build/core"
		/>
	</target>
	<target name="dist-thread" depends="compile-thread">
		<jar jarfile="dist/ahslib-thread.jar" basedir="build/thread"/>
	</target>
	
	<target name="compile-io" depends="compile-thread">
		<ahsjavac
			module="io"
			classes="us/exultant/ahs/io/**"
			depends="build/core : build/thread"
		/>
	</target>
	<target name="dist-io" depends="compile-io">
		<jar jarfile="dist/ahslib-io.jar" basedir="build/io"/>
	</target>
	
	<target name="dist-complete" depends="
			compile-core,
			compile-codec,
			compile-codec-json,
			compile-codec-ebon,
			compile-codec-pre,
			compile-log,
			compile-test,
			compile-test-junit,
			compile-thread,
			compile-io
		">
		<jar jarfile="dist/ahslib-complete.jar">
			<fileset dir="build/core"/>
			<fileset dir="build/codec"/>
			<fileset dir="build/codec-json"/>
			<fileset dir="build/codec-ebon"/>
			<fileset dir="build/codec-pre"/>
			<fileset dir="build/log"/>
			<fileset dir="build/test"/>
			<fileset dir="build/test-junit"/>
			<fileset dir="build/thread"/>
			<fileset dir="build/io"/>
			<!-- does not include scratch, and does not include anything with external dependancies (except junit, because who cares). -->
		</jar>
	</target>
	
	
	<target name="clean" description="clean up">
		<delete dir="build"/>
		<delete dir="dist"/>
	</target>
	
	
	<target name="dox" depends="init" description="generate javadoc">
		<javadoc
			destdir="dox/javadoc"
			author="true"
			version="true"
			use="true"
			windowtitle="AHS Library">
					
			<packageset dir="./src/" defaultexcludes="yes">
				<include name="**"/>
				<exclude name="**todo**"/>
			</packageset>
			<group title="Core"				packages="us.exultant.ahs.core*,us.exultant.ahs.util*"/>
			<group title="Codec Core"			packages="us.exultant.ahs.codec*"/>
			<group title="Codec (JSON)"			packages="us.exultant.ahs.codec.json*"/>
			<group title="Codec (EBON)"			packages="us.exultant.ahs.codec.ebon*"/>
			<group title="Codec (Premade En/Decoders)"	packages="us.exultant.ahs.codec.eon.pre*"/>
			<group title="Logging"				packages="us.exultant.ahs.log*"/>
			<group title="Unit Testing"			packages="us.exultant.ahs.test*"/>
			<group title="Thread"				packages="us.exultant.ahs.thread*"/>
			<group title="IO"				packages="us.exultant.ahs.io*"/>
			<group title="Crypto"				packages="us.exultant.ahs.crypto*"/>
			<group title="Scratch"				packages="us.exultant.ahs.scratch*"/>
		</javadoc>
	</target>
</project>
